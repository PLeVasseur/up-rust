diff -ruN ring_for_rustls_original/Android.bp ring_for_rustls/Android.bp
--- ring_for_rustls_original/Android.bp	1969-12-31 19:00:00.000000000 -0500
+++ ring_for_rustls/Android.bp	2024-02-07 22:56:53.297655000 -0500
@@ -0,0 +1,162 @@
+// This file is generated by cargo_embargo.
+// Do not modify this file as changes will be overridden on upgrade.
+
+// TODO: Add license.
+rust_library {
+name: "libring_for_rustls",
+host_supported: true,
+crate_name: "ring",
+cargo_env_compat: true,
+cargo_pkg_version: "0.17.7",
+srcs: ["src/lib.rs"],
+edition: "2021",
+features: ["alloc", "default", "dev_urandom_fallback", "std"],
+cfgs: ["uuid_unstable", "soong"],
+rustlibs: ["libgetrandom", "libspin", "libuntrusted"],
+whole_static_libs: ["libring-core_for_rustls", "libring-test_for_rustls"],
+apex_available: ["//apex_available:platform", "com.android.resolv"],
+product_available: true,
+vendor_available: true,
+min_sdk_version: "29",
+}
+
+rust_library_rlib {
+name: "libring_nostd_for_rustls",
+crate_name: "ring",
+cargo_env_compat: true,
+cargo_pkg_version: "0.17.7",
+srcs: ["src/lib.rs"],
+edition: "2021",
+features: ["alloc", "default", "dev_urandom_fallback"],
+cfgs: ["uuid_unstable", "soong"],
+rustlibs: ["libgetrandom", "libspin_nostd", "libuntrusted"],
+whole_static_libs: ["libring-core_for_rustls", "libring-test_for_rustls"],
+apex_available: ["//apex_available:platform", "com.android.resolv"],
+prefer_rlib: true,
+no_stdlibs: true,
+stdlibs: ["libcompiler_builtins.rust_sysroot", "libcore.rust_sysroot"],
+product_available: true,
+vendor_available: true,
+min_sdk_version: "29",
+}
+
+cc_library_static {
+    name: "libring-core_for_rustls",
+    host_supported: true,
+    srcs: [
+        "crypto/cpu_intel.c",
+        "crypto/fipsmodule/aes/aes_nohw.c",
+        "crypto/crypto.c",
+        "crypto/poly1305/poly1305.c",
+        "crypto/poly1305/poly1305_vec.c",
+        "crypto/curve25519/curve25519.c",
+        "crypto/fipsmodule/ec/ecp_nistz.c",
+        "crypto/fipsmodule/ec/gfp_p256.c",
+        "crypto/fipsmodule/ec/gfp_p384.c",
+        "crypto/fipsmodule/ec/p256.c",
+        "crypto/fipsmodule/ec/p256-nistz.c",
+        "crypto/limbs/limbs.c",
+        "crypto/mem.c",
+        "crypto/fipsmodule/bn/montgomery.c",
+        "crypto/fipsmodule/bn/montgomery_inv.c",
+    ],
+
+    arch: {
+        arm: {
+            srcs: [
+                "crypto/poly1305/poly1305_arm.c",
+                "crypto/poly1305/poly1305_arm_asm.S",
+                "pregenerated/armv4-mont-linux32.S",
+                "crypto/curve25519/asm/x25519-asm-arm.S",
+                "pregenerated/sha256-armv4-linux32.S",
+                "pregenerated/sha512-armv4-linux32.S",
+                "pregenerated/aesv8-armx-linux32.S",
+                "pregenerated/bsaes-armv7-linux32.S",
+                "pregenerated/ghashv8-armx-linux32.S",
+                "pregenerated/vpaes-armv7-linux32.S",
+                "pregenerated/ghash-armv4-linux32.S",
+                "pregenerated/chacha-armv4-linux32.S",
+            ],
+        },
+        arm64: {
+            srcs: [
+                "pregenerated/aesv8-armx-linux64.S",
+                "pregenerated/armv8-mont-linux64.S",
+                "pregenerated/chacha-armv8-linux64.S",
+                "pregenerated/ghash-neon-armv8-linux64.S",
+                "pregenerated/ghashv8-armx-linux64.S",
+                "pregenerated/sha256-armv8-linux64.S",
+                "pregenerated/sha512-armv8-linux64.S",
+                "pregenerated/vpaes-armv8-linux64.S",
+            ],
+        },
+        x86: {
+            srcs: [
+                "pregenerated/aesni-x86-elf.S",
+                "pregenerated/chacha-x86-elf.S",
+                "pregenerated/ghash-x86-elf.S",
+                "pregenerated/vpaes-x86-elf.S",
+                "pregenerated/x86-mont-elf.S",
+            ],
+        },
+        x86_64: {
+            srcs: [
+                "crypto/curve25519/curve25519_64_adx.c",
+                "third_party/fiat/asm/fiat_curve25519_adx_mul.S",
+                "third_party/fiat/asm/fiat_curve25519_adx_square.S",
+                "pregenerated/aesni-gcm-x86_64-elf.S",
+                "pregenerated/aesni-x86_64-elf.S",
+                "pregenerated/chacha-x86_64-elf.S",
+                "pregenerated/chacha20_poly1305_x86_64-elf.S",
+                "pregenerated/ghash-x86_64-elf.S",
+                "pregenerated/p256-x86_64-asm-elf.S",
+                "pregenerated/sha256-x86_64-elf.S",
+                "pregenerated/sha512-x86_64-elf.S",
+                "pregenerated/vpaes-x86_64-elf.S",
+                "pregenerated/x86_64-mont5-elf.S",
+                "pregenerated/x86_64-mont-elf.S",
+            ],
+        },
+        riscv64: {
+            cflags: ["-DOPENSSL_NO_ASM"],
+        },
+    },
+
+    cflags: [
+        "-O3",
+        "-Wno-error",
+        "-fPIC",
+        "-fdata-sections",
+        "-ffunction-sections",
+        "-fno-omit-frame-pointer",
+        "-fno-strict-aliasing",
+        "-fstack-protector",
+        "-fvisibility=hidden",
+        "-DNDEBUG",
+    ],
+    local_include_dirs: ["include"],
+    apex_available: [
+        "//apex_available:platform",
+        "com.android.resolv",
+    ],
+    vendor_available: true,
+    product_available: true,
+    min_sdk_version: "29",
+}
+
+cc_library_static {
+    name: "libring-test_for_rustls",
+    host_supported: true,
+    srcs: [
+        "crypto/constant_time_test.c",
+    ],
+    local_include_dirs: ["include"],
+    apex_available: [
+        "//apex_available:platform",
+        "com.android.resolv",
+    ],
+    vendor_available: true,
+    product_available: true,
+    min_sdk_version: "29",
+}
+
diff -ruN ring_for_rustls_original/cargo2android_cc.bp ring_for_rustls/cargo2android_cc.bp
--- ring_for_rustls_original/cargo2android_cc.bp	1969-12-31 19:00:00.000000000 -0500
+++ ring_for_rustls/cargo2android_cc.bp	2024-02-07 22:55:37.310247000 -0500
@@ -0,0 +1,119 @@
+cc_library_static {
+    name: "libring-core_for_rustls",
+    host_supported: true,
+    srcs: [
+        "crypto/cpu_intel.c",
+        "crypto/fipsmodule/aes/aes_nohw.c",
+        "crypto/crypto.c",
+        "crypto/poly1305/poly1305.c",
+        "crypto/poly1305/poly1305_vec.c",
+        "crypto/curve25519/curve25519.c",
+        "crypto/fipsmodule/ec/ecp_nistz.c",
+        "crypto/fipsmodule/ec/gfp_p256.c",
+        "crypto/fipsmodule/ec/gfp_p384.c",
+        "crypto/fipsmodule/ec/p256.c",
+        "crypto/fipsmodule/ec/p256-nistz.c",
+        "crypto/limbs/limbs.c",
+        "crypto/mem.c",
+        "crypto/fipsmodule/bn/montgomery.c",
+        "crypto/fipsmodule/bn/montgomery_inv.c",
+    ],
+
+    arch: {
+        arm: {
+            srcs: [
+                "crypto/poly1305/poly1305_arm.c",
+                "crypto/poly1305/poly1305_arm_asm.S",
+                "pregenerated/armv4-mont-linux32.S",
+                "crypto/curve25519/asm/x25519-asm-arm.S",
+                "pregenerated/sha256-armv4-linux32.S",
+                "pregenerated/sha512-armv4-linux32.S",
+                "pregenerated/aesv8-armx-linux32.S",
+                "pregenerated/bsaes-armv7-linux32.S",
+                "pregenerated/ghashv8-armx-linux32.S",
+                "pregenerated/vpaes-armv7-linux32.S",
+                "pregenerated/ghash-armv4-linux32.S",
+                "pregenerated/chacha-armv4-linux32.S",
+            ],
+        },
+        arm64: {
+            srcs: [
+                "pregenerated/aesv8-armx-linux64.S",
+                "pregenerated/armv8-mont-linux64.S",
+                "pregenerated/chacha-armv8-linux64.S",
+                "pregenerated/ghash-neon-armv8-linux64.S",
+                "pregenerated/ghashv8-armx-linux64.S",
+                "pregenerated/sha256-armv8-linux64.S",
+                "pregenerated/sha512-armv8-linux64.S",
+                "pregenerated/vpaes-armv8-linux64.S",
+            ],
+        },
+        x86: {
+            srcs: [
+                "pregenerated/aesni-x86-elf.S",
+                "pregenerated/chacha-x86-elf.S",
+                "pregenerated/ghash-x86-elf.S",
+                "pregenerated/vpaes-x86-elf.S",
+                "pregenerated/x86-mont-elf.S",
+            ],
+        },
+        x86_64: {
+            srcs: [
+                "crypto/curve25519/curve25519_64_adx.c",
+                "third_party/fiat/asm/fiat_curve25519_adx_mul.S",
+                "third_party/fiat/asm/fiat_curve25519_adx_square.S",
+                "pregenerated/aesni-gcm-x86_64-elf.S",
+                "pregenerated/aesni-x86_64-elf.S",
+                "pregenerated/chacha-x86_64-elf.S",
+                "pregenerated/chacha20_poly1305_x86_64-elf.S",
+                "pregenerated/ghash-x86_64-elf.S",
+                "pregenerated/p256-x86_64-asm-elf.S",
+                "pregenerated/sha256-x86_64-elf.S",
+                "pregenerated/sha512-x86_64-elf.S",
+                "pregenerated/vpaes-x86_64-elf.S",
+                "pregenerated/x86_64-mont5-elf.S",
+                "pregenerated/x86_64-mont-elf.S",
+            ],
+        },
+        riscv64: {
+            cflags: ["-DOPENSSL_NO_ASM"],
+        },
+    },
+
+    cflags: [
+        "-O3",
+        "-Wno-error",
+        "-fPIC",
+        "-fdata-sections",
+        "-ffunction-sections",
+        "-fno-omit-frame-pointer",
+        "-fno-strict-aliasing",
+        "-fstack-protector",
+        "-fvisibility=hidden",
+        "-DNDEBUG",
+    ],
+    local_include_dirs: ["include"],
+    apex_available: [
+        "//apex_available:platform",
+        "com.android.resolv",
+    ],
+    vendor_available: true,
+    product_available: true,
+    min_sdk_version: "29",
+}
+
+cc_library_static {
+    name: "libring-test_for_rustls",
+    host_supported: true,
+    srcs: [
+        "crypto/constant_time_test.c",
+    ],
+    local_include_dirs: ["include"],
+    apex_available: [
+        "//apex_available:platform",
+        "com.android.resolv",
+    ],
+    vendor_available: true,
+    product_available: true,
+    min_sdk_version: "29",
+}
diff -ruN ring_for_rustls_original/cargo_embargo.json ring_for_rustls/cargo_embargo.json
--- ring_for_rustls_original/cargo_embargo.json	1969-12-31 19:00:00.000000000 -0500
+++ ring_for_rustls/cargo_embargo.json	2024-02-07 20:41:03.120112000 -0500
@@ -0,0 +1,47 @@
+{
+  "apex_available": [
+    "//apex_available:platform",
+    "com.android.resolv"
+  ],
+  "extra_cfg": ["soong"],
+  "min_sdk_version": "29",
+  "package": {
+    "ring": {
+      "add_toplevel_block": "cargo2android_cc.bp",
+      "whole_static_libs": [
+        "libring-core",
+        "libring-test"
+      ]
+    }
+  },
+  "variants": [
+    {
+      "features": [
+        "alloc",
+        "default",
+        "dev_urandom_fallback",
+        "std"
+      ],
+      "module_name_overrides": {
+        "libring_core_0_17_7_": "libring-core",
+        "libring_core_0_17_7_test": "libring-test"
+      },
+      "tests": false
+    },
+    {
+      "module_name_overrides": {
+        "libring_core_0_17_7_": "libring-core",
+        "libring_core_0_17_7_test": "libring-test",
+        "libring": "libring_nostd",
+        "libspin": "libspin_nostd"
+      },
+      "package": {
+        "ring": {
+          "force_rlib": true,
+          "host_supported": false,
+          "no_std": true
+        }
+      }
+    }
+  ]
+}
